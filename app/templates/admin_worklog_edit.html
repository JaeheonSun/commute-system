{% extends "admin_base.html" %}

{% block title %}Í∑ºÎ¨¥ Í∏∞Î°ù ÏàòÏ†ï/ÏÇ≠Ï†ú{% endblock %}

{% block content %}

<div class="row">

  <!-- üîπ Ï°∞Ìöå Ïπ¥Îìú -->
  <div class="col-md-12">
    <div class="card card-info">
      <div class="card-header">
        <h3 class="card-title">Í∑ºÎ¨¥ Í∏∞Î°ù Ï°∞Ìöå</h3>
      </div>

      <form method="POST">
        <div class="card-body">
          <div class="row">

            <div class="col-md-4">
              <div class="form-group">
                <label>ÏßÅÏõê</label>
                <select name="user_id" class="form-control" required>
                  {% for u in users %}
                  <option value="{{ u.id }}"
                    {% if selected_user == u.id %}selected{% endif %}>
                    {{ u.username }}
                  </option>
                  {% endfor %}
                </select>
              </div>
            </div>

            <div class="col-md-4">
              <div class="form-group">
                <label>Í∑ºÎ¨¥ ÎÇ†Ïßú</label>
                <input type="date"
                       name="work_date"
                       class="form-control"
                       value="{{ selected_date if selected_date }}"
                       required>
              </div>
            </div>

          </div>
        </div>

        <div class="card-footer text-right">
          <button type="submit" class="btn btn-info">
            <i class="fas fa-search"></i> Ï°∞Ìöå
          </button>
        </div>
      </form>
    </div>
  </div>

  {% if record %}
  <!-- üîπ ÏàòÏ†ï Ïπ¥Îìú -->
  <div class="col-md-12">
    <div class="card card-warning">
      <div class="card-header">
        <h3 class="card-title">Í∑ºÎ¨¥ Í∏∞Î°ù ÏàòÏ†ï/ÏÇ≠Ï†ú</h3>
      </div>

      <form method="POST">
        <!-- Ï°∞Ìöå Ï°∞Í±¥ Ïú†ÏßÄ -->
        <input type="hidden" name="user_id" value="{{ selected_user }}">
        <input type="hidden" name="work_date" value="{{ selected_date }}">

        <div class="card-body">
          <div class="row">

            <div class="col-md-3">
              <div class="form-group">
                <label>Ï∂úÍ∑º ÏãúÍ∞Ñ</label>
                <input type="time"
                       name="start_time"
                       class="form-control"
                       value="{{ record.start_time.strftime('%H:%M') }}"
                       required>
              </div>
            </div>

            <div class="col-md-3">
              <div class="form-group">
                <label>Ìá¥Í∑º ÏãúÍ∞Ñ</label>
                <input type="time"
                       name="end_time"
                       class="form-control"
                       value="{{ record.end_time.strftime('%H:%M') if record.end_time else '' }}"
                       required>
              </div>
            </div>

          </div>
        </div>

        <div class="card-footer text-right bg-white">
          <button type="submit" class="btn btn-success">
            <i class="fas fa-save"></i>Ï†ÄÏû•
          </button>
        </div>
      </form>

        <form method="POST"
            action="{{ url_for('admin.delete_worklog') }}"
            onsubmit="return confirm('Ï†ïÎßê Ïù¥ Í∑ºÎ¨¥ Í∏∞Î°ùÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?');"
            class="card-footer text-right">
        <input type="hidden" name="user_id" value="{{ selected_user }}">
        <input type="hidden" name="work_date" value="{{ selected_date }}">
        <button type="submit" class="btn btn-danger">
          <i class="fas fa-trash"></i> ÏÇ≠Ï†ú
        </button>
      </form>
    </div>
  </div>
  {% endif %}

</div>

{% endblock %}
